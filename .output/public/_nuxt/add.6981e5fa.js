import{_ as $}from"./Input.f5e59ea7.js";import{_ as w}from"./layout.b39c5b86.js";import{h as y,i as A,r as C,j as D,w as L,k as S,o as i,a as e,b as h,l as t,c as m,t as l,m as d}from"./entry.0c1eaa11.js";import{u as P,c as n,r as u,a as f}from"./index.56505eb7.js";const V={class:"pt-24 px-4 pb-10"},q=e("h1",{class:"text-center pb-6"},"Adicionar produto",-1),B={class:"flex justify-center"},F={class:"md:w-4/5 lg:w-3/5"},I={action:""},M={class:"mb-2"},N={key:0,class:"text-error font-medium text-xs"},U={class:"mb-2"},j={key:0,class:"text-error font-medium text-xs"},R=e("label",{class:"label"},[e("span",{class:"label-text text-neutral-600"},"Foto do produto")],-1),T={class:"mt-3 md:mb-12"},z=e("label",{class:"border py-3 px-5 cursor-pointer hover:bg-neutral-100",for:"photo"},"Selecionar arquivo",-1),E={key:0,class:"text-error font-medium text-xs mx-2"},H={class:"block mt-6 mx-2 md:mt-0 md:inline"},X={__name:"add",setup(O){const a=y({title:"",link:"",photo:""}),x=A(()=>({title:{required:n.withMessage("Preencha o título",u),maxLength:n.withMessage("Digite no máximo 50 caracteres",f(50))},link:{required:n.withMessage("Preencha o link",u),maxLength:n.withMessage("Digite no máximo 50 caracteres",f(50))},photo:{required:n.withMessage("Selecione a foto",u)}})),o=P(x,a),p=C(""),g=S().public.API_URL,b=async()=>{if(o.value.$validate(),!o.value.$error){const s=new FormData;s.append("title",a.title),s.append("link",a.link),s.append("photo",a.photo),await $fetch(`${g}/products`,{method:"POST",body:s,headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(()=>{appStore.setAlert(!0,"success","Produto adicionado com sucesso.")}).catch(()=>{appStore.setAlert(!0,"error","Houve um erro ao adicionar o produto.")})}},k=s=>{p.value=s.target.files[0].name,a.photo=s.target.files[0]};return(s,r)=>{const _=$,v=w;return i(),D(v,{name:"main"},{content:L(()=>[e("div",V,[q,e("div",B,[e("div",F,[e("form",I,[e("div",M,[h(_,{name:"title",label:"Título",placeholder:"Digite o título do produto","onUpdate:modelValue":r[0]||(r[0]=c=>t(a).title=c)}),t(o).title.$error?(i(),m("span",N,l(t(o).title.$errors[0].$message),1)):d("",!0)]),e("div",U,[h(_,{class:"mb-2",name:"link",label:"Link",placeholder:"Digite o link de afiliado","onUpdate:modelValue":r[1]||(r[1]=c=>t(a).link=c)}),t(o).link.$error?(i(),m("span",j,l(t(o).link.$errors[0].$message),1)):d("",!0)]),R,e("div",T,[z,t(o).photo.$error?(i(),m("span",E,l(t(o).photo.$errors[0].$message),1)):d("",!0),e("span",H,l(t(p)),1),e("input",{type:"file",id:"photo",name:"photo",class:"invisible",onChange:k},null,32)]),e("div",{class:"flex justify-center"},[e("button",{type:"button",class:"btn btn-accent btn-wide",onClick:b},"Adicionar")])])])])])]),_:1})}}};export{X as default};
