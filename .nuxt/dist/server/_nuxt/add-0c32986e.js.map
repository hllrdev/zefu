{"version":3,"file":"add-0c32986e.js","sources":["../../../../pages/products/add.vue"],"sourcesContent":["<script setup>\n    import { required, maxLength, helpers} from \"@vuelidate/validators\";\n    import { useVuelidate  } from \"@vuelidate/core\";\n\n    const formData = reactive({\n        title: '',\n        link: '',\n        photo: ''\n    })\n\n    const rules = computed(() => {\n        return {\n            title: { \n                required: helpers.withMessage('Preencha o título', required),\n                maxLength: helpers.withMessage('Digite no máximo 50 caracteres', maxLength(50))\n            },\n            link: { \n                required: helpers.withMessage('Preencha o link', required),\n                maxLength: helpers.withMessage('Digite no máximo 50 caracteres', maxLength(50))\n            },\n            photo: { required: helpers.withMessage('Selecione a foto', required)}\n        }\n    })\n\n    const v$ = useVuelidate(rules, formData);\n    const photoFilename = ref(\"\");\n\n    const runtimeConfig = useRuntimeConfig();\n    const API_URL = runtimeConfig.public.API_URL;\n\n    const submitForm = async () => {\n        v$.value.$validate();\n        if(!v$.value.$error){\n            const form = new FormData();\n            form.append('title', formData.title);\n            form.append('link', formData.link);\n            form.append('photo', formData.photo);\n\n            await $fetch(`${API_URL}/products`,\n            {\n                method: 'POST',\n                body: form,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token')\n                }\n            }\n            ).then(() => {\n                appStore.setAlert(true, 'success', \"Produto adicionado com sucesso.\");\n            }).catch(() => {\n                appStore.setAlert(true, 'error', \"Houve um erro ao adicionar o produto.\");\n            })\n        }\n    }\n\n    const changeFileInput = (event) => {\n        photoFilename.value = event.target.files[0].name;\n        formData.photo = event.target.files[0];\n    }\n\n    \n</script>\n\n<template>\n    <NuxtLayout name=\"main\">\n        <template #content>\n            <div class=\"pt-24 px-4 pb-10\">\n                <h1 class=\"text-center pb-6\">Adicionar produto</h1>\n                <div class=\"flex justify-center\">\n                    <div class=\"md:w-4/5 lg:w-3/5\">\n                        <form action=\"\">\n                            <div class=\"mb-2\">\n                                <Input  name=\"title\" label=\"Título\" placeholder=\"Digite o título do produto\" @update:model-value=\"formData.title = $event\" />\n                                <span class=\"text-error font-medium text-xs\" v-if=\"v$.title.$error\">{{ v$.title.$errors[0].$message }}</span>\n                            </div>\n                            <div class=\"mb-2\">\n                                <Input class=\"mb-2\" name=\"link\" label=\"Link\" placeholder=\"Digite o link de afiliado\" @update:model-value=\"formData.link = $event\" />\n                                <span class=\"text-error font-medium text-xs\" v-if=\"v$.link.$error\">{{ v$.link.$errors[0].$message }}</span>\n                            </div>\n                            <label class=\"label\">\n                                <span class=\"label-text text-neutral-600\">Foto do produto</span>\n                            </label>\n                            <div class=\"mt-3 md:mb-12\">\n                                <label class=\"border py-3 px-5 cursor-pointer hover:bg-neutral-100\" for=\"photo\">Selecionar arquivo</label>\n                                <span class=\"text-error font-medium text-xs mx-2\" v-if=\"v$.photo.$error\">{{ v$.photo.$errors[0].$message }}</span>\n                                <span class=\"block mt-6 mx-2 md:mt-0 md:inline\" >{{ photoFilename }}</span>\n                                <input type=\"file\" id=\"photo\" name=\"photo\" class=\"invisible\" @change=\"changeFileInput\" />\n                            </div>\n                            <div class=\"flex justify-center\">\n                                <button type=\"button\" class=\"btn btn-accent btn-wide\" @click=\"submitForm\">Adicionar</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </template>\n    </NuxtLayout>\n</template>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAII,UAAM,WAAW,SAAS;AAAA,MACtB,OAAO;AAAA,MACP,MAAM;AAAA,MACN,OAAO;AAAA,IACf,CAAK;AAED,UAAM,QAAQ,SAAS,MAAM;AACzB,aAAO;AAAA,QACH,OAAO;AAAA,UACH,UAAU,QAAQ,YAAY,qBAAqB,QAAQ;AAAA,UAC3D,WAAW,QAAQ,YAAY,kCAAkC,UAAU,EAAE,CAAC;AAAA,QACjF;AAAA,QACD,MAAM;AAAA,UACF,UAAU,QAAQ,YAAY,mBAAmB,QAAQ;AAAA,UACzD,WAAW,QAAQ,YAAY,kCAAkC,UAAU,EAAE,CAAC;AAAA,QACjF;AAAA,QACD,OAAO,EAAE,UAAU,QAAQ,YAAY,oBAAoB,QAAQ,EAAC;AAAA,MACvE;AAAA,IACT,CAAK;AAED,UAAM,KAAK,aAAa,OAAO,QAAQ;AACvC,UAAM,gBAAgB,IAAI,EAAE;AAE5B,UAAM,gBAAiC;AACvC,UAAM,UAAU,cAAc,OAAO;AAErC,UAAM,aAAa,YAAY;AAC3B,SAAG,MAAM;AACT,UAAG,CAAC,GAAG,MAAM,QAAO;AAChB,cAAM,OAAO,IAAI;AACjB,aAAK,OAAO,SAAS,SAAS,KAAK;AACnC,aAAK,OAAO,QAAQ,SAAS,IAAI;AACjC,aAAK,OAAO,SAAS,SAAS,KAAK;AAEnC,cAAM;AAAA,UAAO,GAAG;AAAA,UAChB;AAAA,YACI,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,SAAS;AAAA,cACL,iBAAiB,YAAY,aAAa,QAAQ,OAAO;AAAA,YAC5D;AAAA,UACJ;AAAA,QACA,EAAC,KAAK,MAAM;AACT,mBAAS,SAAS,MAAM,WAAW,iCAAiC;AAAA,QACpF,CAAa,EAAE,MAAM,MAAM;AACX,mBAAS,SAAS,MAAM,SAAS,uCAAuC;AAAA,QACxF,CAAa;AAAA,MACJ;AAAA,IACJ;AAED,UAAM,kBAAkB,CAAC,UAAU;AAC/B,oBAAc,QAAQ,MAAM,OAAO,MAAM,CAAC,EAAE;AAC5C,eAAS,QAAQ,MAAM,OAAO,MAAM,CAAC;AAAA,IACxC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}