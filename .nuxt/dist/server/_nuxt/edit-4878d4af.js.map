{"version":3,"file":"edit-4878d4af.js","sources":["../../../../pages/products/edit.vue"],"sourcesContent":["<script setup>\n    const changeFileInput = (event) => {\n        const selectedFile = event.target.files[0];\n        formData.photo = selectedFile;\n        photoFilename.value = selectedFile.name;\n        \n        const reader = new FileReader();\n        reader.addEventListener(\"load\", function() {\n            imagePreview.value = reader.result;\n        });\n\n        reader.readAsDataURL(event.target.files[0]);\n    }\n\n    const imagePreview = ref('');\n    const route = useRoute();\n    const router = useRouter();\n    const values = route.query;\n    const initialImage = values.photo;\n    const photoFilename = ref('');\n\n    onMounted(() => {\n        try {\n            photoFilename.value = ref(values.photo.split(\"/\").slice(-1)[0]);\n        } catch (error) {\n            router.push('/errors/404')\n        }\n        \n    })\n    \n    const formData = reactive({\n        id: values.id,\n        title: values.title,\n        link: values.link,\n        photo: values.photo\n    })\n\n    import { required, maxLength, helpers} from \"@vuelidate/validators\";\n\n    const rules = computed(() => {\n        return {\n            title: { \n                required: helpers.withMessage('Preencha o título', required),\n                maxLength: helpers.withMessage('Digite no máximo 50 caracteres', maxLength(50))\n            },\n            link: { \n                required: helpers.withMessage('Preencha o link', required),\n                maxLength: helpers.withMessage('Digite no máximo 50 caracteres', maxLength(50))\n            }\n        }\n    })\n\n    import { useVuelidate  } from \"@vuelidate/core\";\n    const v$ = useVuelidate(rules, formData);\n\n    const submitForm = async () => {\n        v$.value.$validate();\n        if(!v$.value.$error){\n            const form = new FormData();\n            if(formData.photo == initialImage)\n                form.append('photo', null);\n            else\n                form.append('photo', formData.photo);\n\n            form.append('title', formData.title);\n            form.append('link', formData.link);\n\n            await $fetch(`${API_URL}/products/${formData.id}`,\n            {\n                method: 'PUT',\n                body: form,\n                headers: {\n                    'Authorization': 'Bearer ' + localStorage.getItem('token')\n                }\n            }\n            ).then(() => {\n                appStore.setAlert(true, 'success', \"Produto editado com sucesso.\");\n            }).catch(() => {\n                appStore.setAlert(true, 'error', \"Houve um erro ao editar o produto.\");\n            })\n        }\n    }\n\n</script>\n\n<template>\n    <NuxtLayout name=\"main\">\n        <template #content>\n            <div class=\"pt-24 px-4 pb-10\">\n                <h1 class=\"text-center pb-6\">Editar produto</h1>\n                <div class=\"flex justify-center\">\n                    <div class=\"md:w-4/5 lg:w-3/5\">\n                        <form action=\"\">\n                            <div class=\"mb-2\">\n                                <Input :value=\"formData.title\" class=\"mb-2\" size=\"md:max-w-2xl\" name=\"title\" label=\"Título\" placeholder=\"Digite o título do produto\" v-model=\"formData.title\" @update:model-value=\"formData.title = $event\" />\n                                <span class=\"text-error font-medium text-xs\" v-if=\"v$.title.$error\">{{ v$.title.$errors[0].$message }}</span>\n                            </div>\n                            <div class=\"mb-2\">\n                                <Input :value=\"formData.link\" class=\"mb-2\" size=\"md:max-w-2xl\" name=\"link\" label=\"Link\" placeholder=\"Digite o link de afiliado\" v-model=\"formData.link\" @update:model-value=\"formData.link = $event\" />\n                                <span class=\"text-error font-medium text-xs\" v-if=\"v$.link.$error\">{{ v$.link.$errors[0].$message }}</span>\n                            </div>\n                            <label class=\"label\">\n                                <span class=\"label-text text-neutral-600\">Foto do produto</span>\n                            </label>\n                            <div class=\"mt-3 md:mb-12\">\n                                <label class=\"border py-3 px-5 cursor-pointer hover:bg-neutral-100\" for=\"photo\">Selecionar arquivo</label>\n                                <span class=\"block mt-6 mx-2 md:mt-0 md:inline\" >{{ photoFilename }}</span>\n                                <input type=\"file\" id=\"photo\" name=\"photo\" class=\"invisible\" @change=\"changeFileInput\" />\n                            </div>\n                            <div class=\"flex justify-center pb-6 pt-2\">\n                                <img class=\"w-72\" :src=\"imagePreview ? imagePreview  : `${API_URL}/static${initialImage}`\" />\n                            </div>\n                            <div class=\"flex justify-center\">\n                                <button type=\"button\" class=\"btn btn-accent btn-wide\" @click=\"submitForm\">Editar</button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </template>\n    </NuxtLayout>\n</template>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACI,UAAM,kBAAkB,CAAC,UAAU;AAC/B,YAAM,eAAe,MAAM,OAAO,MAAM,CAAC;AACzC,eAAS,QAAQ;AACjB,oBAAc,QAAQ,aAAa;AAEnC,YAAM,SAAS,IAAI;AACnB,aAAO,iBAAiB,QAAQ,WAAW;AACvC,qBAAa,QAAQ,OAAO;AAAA,MACxC,CAAS;AAED,aAAO,cAAc,MAAM,OAAO,MAAM,CAAC,CAAC;AAAA,IAC7C;AAED,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,QAAQ;AACC,cAAY;AAC3B,UAAM,SAAS,MAAM;AACrB,UAAM,eAAe,OAAO;AAC5B,UAAM,gBAAgB,IAAI,EAAE;AAW5B,UAAM,WAAW,SAAS;AAAA,MACtB,IAAI,OAAO;AAAA,MACX,OAAO,OAAO;AAAA,MACd,MAAM,OAAO;AAAA,MACb,OAAO,OAAO;AAAA,IACtB,CAAK;AAID,UAAM,QAAQ,SAAS,MAAM;AACzB,aAAO;AAAA,QACH,OAAO;AAAA,UACH,UAAU,QAAQ,YAAY,qBAAqB,QAAQ;AAAA,UAC3D,WAAW,QAAQ,YAAY,kCAAkC,UAAU,EAAE,CAAC;AAAA,QACjF;AAAA,QACD,MAAM;AAAA,UACF,UAAU,QAAQ,YAAY,mBAAmB,QAAQ;AAAA,UACzD,WAAW,QAAQ,YAAY,kCAAkC,UAAU,EAAE,CAAC;AAAA,QACjF;AAAA,MACJ;AAAA,IACT,CAAK;AAGD,UAAM,KAAK,aAAa,OAAO,QAAQ;AAEvC,UAAM,aAAa,YAAY;AAC3B,SAAG,MAAM;AACT,UAAG,CAAC,GAAG,MAAM,QAAO;AAChB,cAAM,OAAO,IAAI;AACjB,YAAG,SAAS,SAAS;AACjB,eAAK,OAAO,SAAS,IAAI;AAAA;AAEzB,eAAK,OAAO,SAAS,SAAS,KAAK;AAEvC,aAAK,OAAO,SAAS,SAAS,KAAK;AACnC,aAAK,OAAO,QAAQ,SAAS,IAAI;AAEjC,cAAM;AAAA,UAAO,GAAG,oBAAoB,SAAS;AAAA,UAC7C;AAAA,YACI,QAAQ;AAAA,YACR,MAAM;AAAA,YACN,SAAS;AAAA,cACL,iBAAiB,YAAY,aAAa,QAAQ,OAAO;AAAA,YAC5D;AAAA,UACJ;AAAA,QACA,EAAC,KAAK,MAAM;AACT,mBAAS,SAAS,MAAM,WAAW,8BAA8B;AAAA,QACjF,CAAa,EAAE,MAAM,MAAM;AACX,mBAAS,SAAS,MAAM,SAAS,oCAAoC;AAAA,QACrF,CAAa;AAAA,MACJ;AAAA,IACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}